{% comment %}
  Editorial navigation menu with hover images
  Clean, minimalist design with numbered links and image previews on hover
{% endcomment %}

{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-nav-menu-{{ ai_gen_id }} {
    background-color: {{ block.settings.background_color }};
    border: {{ block.settings.border_width }}px solid {{ block.settings.border_color }};
    padding: {{ block.settings.padding_vertical }}px {{ block.settings.padding_horizontal }}px;
    max-width: 100%;
  }

  .ai-nav-menu__list-{{ ai_gen_id }} {
    list-style: none;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: {{ block.settings.item_spacing }}px;
  }

  .ai-nav-menu__item-{{ ai_gen_id }} {
    position: relative;
  }

  .ai-nav-menu__number-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: -24px;
    font-family: {{ block.settings.font_family.family }}, {{ block.settings.font_family.fallback_families }};
    font-size: {{ block.settings.number_size }}px;
    color: {{ block.settings.text_color }};
    font-weight: 300;
    line-height: 1;
    opacity: 0.6;
  }

  .ai-nav-menu__link-{{ ai_gen_id }} {
    font-family: {{ block.settings.font_family.family }}, {{ block.settings.font_family.fallback_families }};
    color: {{ block.settings.text_color }};
    text-decoration: none;
    font-weight: {{ block.settings.font_family.weight }};
    font-style: {{ block.settings.font_family.style }};
    line-height: 1;
    transition: color 0.3s ease;
    font-size: {{ block.settings.link_size }}px;
    display: inline-block;
    cursor: pointer;
  }

  .ai-nav-menu__link-{{ ai_gen_id }}:hover {
    color: {{ block.settings.hover_color }};
  }

  .ai-nav-menu__preview-{{ ai_gen_id }} {
    position: fixed;
    pointer-events: none;
    z-index: 9999;
    opacity: 0;
    transform: translateY(10px) scale(0.95);
    transition: opacity {{ block.settings.image_transition_speed }}s ease, 
                transform {{ block.settings.image_transition_speed }}s cubic-bezier(0.34, 1.56, 0.64, 1);
    will-change: transform, opacity;
  }

  .ai-nav-menu__preview-{{ ai_gen_id }}.visible {
    opacity: 1;
    transform: translateY(0) scale(1);
  }

  .ai-nav-menu__preview-inner-{{ ai_gen_id }} {
    background: {{ block.settings.image_background }};
    border-radius: {{ block.settings.image_border_radius }}px;
    padding: {{ block.settings.image_padding }}px;
    box-shadow: 0 {{ block.settings.image_shadow_blur }}px {{ block.settings.image_shadow_spread }}px rgba(0, 0, 0, {{ block.settings.image_shadow_opacity }}),
                0 0 0 {{ block.settings.image_border_width }}px {{ block.settings.image_border_color }};
    overflow: hidden;
    backdrop-filter: blur(10px);
  }

  .ai-nav-menu__preview-image-{{ ai_gen_id }} {
    width: {{ block.settings.image_width }}px;
    height: {{ block.settings.image_height }}px;
    object-fit: cover;
    border-radius: calc({{ block.settings.image_border_radius }}px - 4px);
    display: block;
  }

  @media screen and (max-width: 749px) {
    .ai-nav-menu__number-{{ ai_gen_id }} {
      font-size: calc({{ block.settings.number_size }}px * 0.7);
      left: -18px;
    }

    .ai-nav-menu__link-{{ ai_gen_id }} {
      font-size: calc({{ block.settings.link_size }}px * 0.6);
    }

    .ai-nav-menu__preview-image-{{ ai_gen_id }} {
      width: calc({{ block.settings.image_width }}px * 0.8);
      height: calc({{ block.settings.image_height }}px * 0.8);
    }

    .ai-nav-menu__preview-inner-{{ ai_gen_id }} {
      padding: calc({{ block.settings.image_padding }}px * 0.8);
    }
  }
{% endstyle %}

<nav class="ai-nav-menu-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <ul class="ai-nav-menu__list-{{ ai_gen_id }}">
    {% if block.settings.link_1_text != blank %}
      <li class="ai-nav-menu__item-{{ ai_gen_id }}">
        <span class="ai-nav-menu__number-{{ ai_gen_id }}">1</span>
        <a href="{{ block.settings.link_1_url }}" 
           class="ai-nav-menu__link-{{ ai_gen_id }}"
           data-preview-image="{% if block.settings.link_1_image != blank %}{{ block.settings.link_1_image | img_url: 'master' }}{% endif %}"
           data-preview-text="{{ block.settings.link_1_text }}">
          {{ block.settings.link_1_text }}
        </a>
      </li>
    {% endif %}

    {% if block.settings.link_2_text != blank %}
      <li class="ai-nav-menu__item-{{ ai_gen_id }}">
        <span class="ai-nav-menu__number-{{ ai_gen_id }}">2</span>
        <a href="{{ block.settings.link_2_url }}" 
           class="ai-nav-menu__link-{{ ai_gen_id }}"
           data-preview-image="{% if block.settings.link_2_image != blank %}{{ block.settings.link_2_image | img_url: 'master' }}{% endif %}"
           data-preview-text="{{ block.settings.link_2_text }}">
          {{ block.settings.link_2_text }}
        </a>
      </li>
    {% endif %}

    {% if block.settings.link_3_text != blank %}
      <li class="ai-nav-menu__item-{{ ai_gen_id }}">
        <span class="ai-nav-menu__number-{{ ai_gen_id }}">3</span>
        <a href="{{ block.settings.link_3_url }}" 
           class="ai-nav-menu__link-{{ ai_gen_id }}"
           data-preview-image="{% if block.settings.link_3_image != blank %}{{ block.settings.link_3_image | img_url: 'master' }}{% endif %}"
           data-preview-text="{{ block.settings.link_3_text }}">
          {{ block.settings.link_3_text }}
        </a>
      </li>
    {% endif %}

    {% if block.settings.link_4_text != blank %}
      <li class="ai-nav-menu__item-{{ ai_gen_id }}">
        <span class="ai-nav-menu__number-{{ ai_gen_id }}">4</span>
        <a href="{{ block.settings.link_4_url }}" 
           class="ai-nav-menu__link-{{ ai_gen_id }}"
           data-preview-image="{% if block.settings.link_4_image != blank %}{{ block.settings.link_4_image | img_url: 'master' }}{% endif %}"
           data-preview-text="{{ block.settings.link_4_text }}">
          {{ block.settings.link_4_text }}
        </a>
      </li>
    {% endif %}

    {% if block.settings.link_5_text != blank %}
      <li class="ai-nav-menu__item-{{ ai_gen_id }}">
        <span class="ai-nav-menu__number-{{ ai_gen_id }}">5</span>
        <a href="{{ block.settings.link_5_url }}" 
           class="ai-nav-menu__link-{{ ai_gen_id }}"
           data-preview-image="{% if block.settings.link_5_image != blank %}{{ block.settings.link_5_image | img_url: 'master' }}{% endif %}"
           data-preview-text="{{ block.settings.link_5_text }}">
          {{ block.settings.link_5_text }}
        </a>
      </li>
    {% endif %}

    {% if block.settings.link_6_text != blank %}
      <li class="ai-nav-menu__item-{{ ai_gen_id }}">
        <span class="ai-nav-menu__number-{{ ai_gen_id }}">6</span>
        <a href="{{ block.settings.link_6_url }}" 
           class="ai-nav-menu__link-{{ ai_gen_id }}"
           data-preview-image="{% if block.settings.link_6_image != blank %}{{ block.settings.link_6_image | img_url: 'master' }}{% endif %}"
           data-preview-text="{{ block.settings.link_6_text }}">
          {{ block.settings.link_6_text }}
        </a>
      </li>
    {% endif %}

    {% if block.settings.link_7_text != blank %}
      <li class="ai-nav-menu__item-{{ ai_gen_id }}">
        <span class="ai-nav-menu__number-{{ ai_gen_id }}">7</span>
        <a href="{{ block.settings.link_7_url }}" 
           class="ai-nav-menu__link-{{ ai_gen_id }}"
           data-preview-image="{% if block.settings.link_7_image != blank %}{{ block.settings.link_7_image | img_url: 'master' }}{% endif %}"
           data-preview-text="{{ block.settings.link_7_text }}">
          {{ block.settings.link_7_text }}
        </a>
      </li>
    {% endif %}

    {% if block.settings.link_8_text != blank %}
      <li class="ai-nav-menu__item-{{ ai_gen_id }}">
        <span class="ai-nav-menu__number-{{ ai_gen_id }}">8</span>
        <a href="{{ block.settings.link_8_url }}" 
           class="ai-nav-menu__link-{{ ai_gen_id }}"
           data-preview-image="{% if block.settings.link_8_image != blank %}{{ block.settings.link_8_image | img_url: 'master' }}{% endif %}"
           data-preview-text="{{ block.settings.link_8_text }}">
          {{ block.settings.link_8_text }}
        </a>
      </li>
    {% endif %}

    {% if block.settings.link_9_text != blank %}
      <li class="ai-nav-menu__item-{{ ai_gen_id }}">
        <span class="ai-nav-menu__number-{{ ai_gen_id }}">9</span>
        <a href="{{ block.settings.link_9_url }}" 
           class="ai-nav-menu__link-{{ ai_gen_id }}"
           data-preview-image="{% if block.settings.link_9_image != blank %}{{ block.settings.link_9_image | img_url: 'master' }}{% endif %}"
           data-preview-text="{{ block.settings.link_9_text }}">
          {{ block.settings.link_9_text }}
        </a>
      </li>
    {% endif %}

    {% if block.settings.link_10_text != blank %}
      <li class="ai-nav-menu__item-{{ ai_gen_id }}">
        <span class="ai-nav-menu__number-{{ ai_gen_id }}">10</span>
        <a href="{{ block.settings.link_10_url }}" 
           class="ai-nav-menu__link-{{ ai_gen_id }}"
           data-preview-image="{% if block.settings.link_10_image != blank %}{{ block.settings.link_10_image | img_url: 'master' }}{% endif %}"
           data-preview-text="{{ block.settings.link_10_text }}">
          {{ block.settings.link_10_text }}
        </a>
      </li>
    {% endif %}
  </ul>
  
  <!-- Preview Card -->
  <div class="ai-nav-menu__preview-{{ ai_gen_id }}" id="preview-card-{{ ai_gen_id }}">
    <div class="ai-nav-menu__preview-inner-{{ ai_gen_id }}">
      <img class="ai-nav-menu__preview-image-{{ ai_gen_id }}" id="preview-image-{{ ai_gen_id }}" alt="">
    </div>
  </div>
</nav>

<script>
(function() {
  const navId = '{{ ai_gen_id }}';
  const links = document.querySelectorAll('.ai-nav-menu__link-' + navId);
  const previewCard = document.getElementById('preview-card-' + navId);
  const previewImage = document.getElementById('preview-image-' + navId);
  
  if (!previewCard || !previewImage) return;
  
  const isMobile = window.innerWidth <= 749;
  const cardWidth = ({{ block.settings.image_width }} + ({{ block.settings.image_padding }} * 2)) * (isMobile ? 0.8 : 1);
  const cardHeight = ({{ block.settings.image_height }} + ({{ block.settings.image_padding }} * 2)) * (isMobile ? 0.8 : 1);
  const offsetY = 20;
  
  function updatePosition(e) {
    const clientX = e.clientX || (e.touches && e.touches[0].clientX);
    const clientY = e.clientY || (e.touches && e.touches[0].clientY);
    
    if (!clientX || !clientY) return;
    
    let x = clientX - cardWidth / 2;
    let y = clientY - cardHeight - offsetY;
    
    if (x + cardWidth > window.innerWidth - 20) {
      x = window.innerWidth - cardWidth - 20;
    }
    if (x < 20) {
      x = 20;
    }
    
    if (y < 20) {
      y = clientY + offsetY;
    }
    
    previewCard.style.left = x + 'px';
    previewCard.style.top = y + 'px';
  }
  
  function showPreview(link, e) {
    const imageUrl = link.getAttribute('data-preview-image');
    const text = link.getAttribute('data-preview-text');
    
    if (imageUrl && imageUrl !== '') {
      previewImage.src = imageUrl;
      previewImage.alt = text || '';
      previewCard.classList.add('visible');
      updatePosition(e);
    }
  }
  
  function hidePreview() {
    previewCard.classList.remove('visible');
  }
  
  links.forEach(function(link) {
    // Desktop events
    link.addEventListener('mouseenter', function(e) {
      showPreview(this, e);
    });
    
    link.addEventListener('mousemove', function(e) {
      if (previewCard.classList.contains('visible')) {
        updatePosition(e);
      }
    });
    
    link.addEventListener('mouseleave', function() {
      hidePreview();
    });
    
    // Mobile touch events
    link.addEventListener('touchstart', function(e) {
      e.preventDefault();
      showPreview(this, e);
    });
    
    link.addEventListener('touchmove', function(e) {
      if (previewCard.classList.contains('visible')) {
        updatePosition(e);
      }
    });
    
    link.addEventListener('touchend', function() {
      setTimeout(hidePreview, 300);
    });
  });
  
  // Close preview when touching outside
  document.addEventListener('touchstart', function(e) {
    let isLink = false;
    links.forEach(function(link) {
      if (link.contains(e.target)) {
        isLink = true;
      }
    });
    if (!isLink && previewCard.classList.contains('visible')) {
      hidePreview();
    }
  });
})();
</script>

{% schema %}
{
  "name": "Editorial navigation menu",
  "settings": [
    {
      "type": "header",
      "content": "Style"
    },
    {
      "type": "font_picker",
      "id": "font_family",
      "label": "Font",
      "default": "serif"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "hover_color",
      "label": "Hover color",
      "default": "#666666"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "border_width",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit": "px",
      "label": "Border width",
      "default": 1
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "range",
      "id": "padding_vertical",
      "min": 10,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Vertical padding",
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_horizontal",
      "min": 10,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Horizontal padding",
      "default": 20
    },
    {
      "type": "range",
      "id": "item_spacing",
      "min": 4,
      "max": 30,
      "step": 2,
      "unit": "px",
      "label": "Space between items",
      "default": 10
    },
    {
      "type": "header",
      "content": "Typography sizes"
    },
    {
      "type": "range",
      "id": "number_size",
      "min": 12,
      "max": 30,
      "step": 1,
      "unit": "px",
      "label": "Number size",
      "default": 20
    },
    {
      "type": "range",
      "id": "link_size",
      "min": 20,
      "max": 80,
      "step": 2,
      "unit": "px",
      "label": "Link text size",
      "default": 48
    },
    {
      "type": "header",
      "content": "Hover image settings"
    },
    {
      "type": "range",
      "id": "image_width",
      "min": 100,
      "max": 500,
      "step": 10,
      "unit": "px",
      "label": "Image width",
      "default": 280
    },
    {
      "type": "range",
      "id": "image_height",
      "min": 100,
      "max": 500,
      "step": 10,
      "unit": "px",
      "label": "Image height",
      "default": 200
    },
    {
      "type": "range",
      "id": "image_padding",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Card padding",
      "default": 8
    },
    {
      "type": "color",
      "id": "image_background",
      "label": "Card background",
      "default": "#1a1a1a"
    },
    {
      "type": "range",
      "id": "image_border_radius",
      "min": 0,
      "max": 50,
      "step": 2,
      "unit": "px",
      "label": "Border radius",
      "default": 16
    },
    {
      "type": "range",
      "id": "image_border_width",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit": "px",
      "label": "Border width",
      "default": 1
    },
    {
      "type": "color",
      "id": "image_border_color",
      "label": "Border color",
      "default": "rgba(255, 255, 255, 0.1)"
    },
    {
      "type": "range",
      "id": "image_shadow_blur",
      "min": 0,
      "max": 50,
      "step": 2,
      "unit": "px",
      "label": "Shadow blur",
      "default": 24
    },
    {
      "type": "range",
      "id": "image_shadow_spread",
      "min": 0,
      "max": 30,
      "step": 2,
      "unit": "px",
      "label": "Shadow spread",
      "default": 12
    },
    {
      "type": "range",
      "id": "image_shadow_opacity",
      "min": 0,
      "max": 1,
      "step": 0.1,
      "label": "Shadow opacity",
      "default": 0.8
    },
    {
      "type": "range",
      "id": "image_transition_speed",
      "min": 0.1,
      "max": 1,
      "step": 0.1,
      "unit": "s",
      "label": "Transition speed",
      "default": 0.3
    },
    {
      "type": "header",
      "content": "Link 1"
    },
    {
      "type": "text",
      "id": "link_1_text",
      "label": "Text",
      "default": "Shop All"
    },
    {
      "type": "url",
      "id": "link_1_url",
      "label": "URL"
    },
    {
      "type": "image_picker",
      "id": "link_1_image",
      "label": "Hover image"
    },
    {
      "type": "header",
      "content": "Link 2"
    },
    {
      "type": "text",
      "id": "link_2_text",
      "label": "Text",
      "default": "New"
    },
    {
      "type": "url",
      "id": "link_2_url",
      "label": "URL"
    },
    {
      "type": "image_picker",
      "id": "link_2_image",
      "label": "Hover image"
    },
    {
      "type": "header",
      "content": "Link 3"
    },
    {
      "type": "text",
      "id": "link_3_text",
      "label": "Text",
      "default": "Bubbles"
    },
    {
      "type": "url",
      "id": "link_3_url",
      "label": "URL"
    },
    {
      "type": "image_picker",
      "id": "link_3_image",
      "label": "Hover image"
    },
    {
      "type": "header",
      "content": "Link 4"
    },
    {
      "type": "text",
      "id": "link_4_text",
      "label": "Text",
      "default": "Non-Alcoholic"
    },
    {
      "type": "url",
      "id": "link_4_url",
      "label": "URL"
    },
    {
      "type": "image_picker",
      "id": "link_4_image",
      "label": "Hover image"
    },
    {
      "type": "header",
      "content": "Link 5"
    },
    {
      "type": "text",
      "id": "link_5_text",
      "label": "Text",
      "default": "Sale"
    },
    {
      "type": "url",
      "id": "link_5_url",
      "label": "URL"
    },
    {
      "type": "image_picker",
      "id": "link_5_image",
      "label": "Hover image"
    },
    {
      "type": "header",
      "content": "Link 6"
    },
    {
      "type": "text",
      "id": "link_6_text",
      "label": "Text",
      "default": "Reds"
    },
    {
      "type": "url",
      "id": "link_6_url",
      "label": "URL"
    },
    {
      "type": "image_picker",
      "id": "link_6_image",
      "label": "Hover image"
    },
    {
      "type": "header",
      "content": "Link 7"
    },
    {
      "type": "text",
      "id": "link_7_text",
      "label": "Text",
      "default": "White"
    },
    {
      "type": "url",
      "id": "link_7_url",
      "label": "URL"
    },
    {
      "type": "image_picker",
      "id": "link_7_image",
      "label": "Hover image"
    },
    {
      "type": "header",
      "content": "Link 8"
    },
    {
      "type": "text",
      "id": "link_8_text",
      "label": "Text",
      "default": "Pink/Orange"
    },
    {
      "type": "url",
      "id": "link_8_url",
      "label": "URL"
    },
    {
      "type": "image_picker",
      "id": "link_8_image",
      "label": "Hover image"
    },
    {
      "type": "header",
      "content": "Link 9"
    },
    {
      "type": "text",
      "id": "link_9_text",
      "label": "Text",
      "default": "Beer"
    },
    {
      "type": "url",
      "id": "link_9_url",
      "label": "URL"
    },
    {
      "type": "image_picker",
      "id": "link_9_image",
      "label": "Hover image"
    },
    {
      "type": "header",
      "content": "Link 10"
    },
    {
      "type": "text",
      "id": "link_10_text",
      "label": "Text",
      "default": "Spirits"
    },
    {
      "type": "url",
      "id": "link_10_url",
      "label": "URL"
    },
    {
      "type": "image_picker",
      "id": "link_10_image",
      "label": "Hover image"
    }
  ],
  "presets": [
    {
      "name": "Editorial navigation menu"
    }
  ]
}
{% endschema %}